---
title: 2024 Weekly Report 3
date: '2024-01-21'
tags: ['Weekly Report']
draft: false
images: []
summary: 2024第3周周报
---

<TOCInline toc={props.toc}/>

## 工作

### SPF 解析
这周碰到个奇怪的问题，某证券客户在调用邮件推送的 API 进行发信时，对某一个域名(gmail、outlook)的邮箱发信总是时灵时不灵，调用失败的时候报错 `Blocked due to SPF policy setting with result (Fail)`,
在域名服务商检查 `DNS SPF(TXT) 解析` 发现配置正常，`dig -q=txt xxx.com @8.8.8.8` 发现也发现 `TXT(SPF)` 解析正常，但调用 API 时就是时不时的会 `Blocked by Sender Policy Framework`

最后我登录到DNS域名控制台才破案，发现这个客户设置了2条独立的 SPF 解析，不同的SPF解析会冲突，导致发信时随机解析一个SPF解析，对的就发信成功，不对的就发信失败，只能删掉1条，或者合并成1条。

dig 排查的时候看到太多 txt 解析了，密密麻麻的输出让我没注意到有2条SPF解析，到控制台看的时候才发现问题，又多走了一段弯路...
![SPFDuplicate](/static/images/SPFDuplicate.png)


解决方法：将2条合并成一条 `v=spf1 ip4:1.1.1.1/26 ip4:2.2.2.2 include:spfdm-ap1x.com include:spfdm-ap2x.com ~all`

PS: 这个券商客户直接把DNS控制台的账密给我去操作，而且变更不用提工单，直接让我来排查问题，相当于直接把整个公司核心基础设施之一的admin权限给我了，这种被信任的感觉真的很不错，但这个信息安全问题... 真就一草台班子

### 网络抖动问题

接上周的工作，我把多台服务器迁移到同一台宿主机了。内网RTT降低了4倍，内网通信时延的P99也可以多加几个9了，应该算是解决这个网络抖动的问题了。

总结：公有云的网络中有n多层的 virtualization 在中间，不是单纯的几台服务器用物理交换机连在一起。只要不是在同一宿主机或者网络拓扑，在多租户的场景下，low latency 就没法保证


-------------------

**这部分工作算是告一段落了，新的旅程即将开始**

## 生活

- 去香港办了`HSBC`的卡，直接从落马洲坐地铁到上水，在上水地铁口附件那家办的，没有预约，直接取号排队就可，过程十分顺利，没有问办卡原因，直接办理，经理姐姐沟通能力很强，业务能力强，体验非常不错。<br></br>
还顺便申请了 `ZA Bank` 和 `Airstar Bank` 的虚拟银行卡<br></br>
中银香港去了3家都没有办成，3家都把我拒了，我给的办卡理由分别是:
  - 1 想来香港工作，工作人员让我有了具体工作后再申请。
  - 2 想投资港股，工作人员问我预期投资额度、投资经验，然后把我拒了。
  - 3 想办卡进行储蓄和转账收账，工作人员直接回复我这样是不合规的<br></br>


- 离开深圳了，果然房东没有退押金，毕竟合同上我是违约的一方，感觉这种一年一签的合同让很多打工人都处于了弱势地位。匆匆离开深圳，没能有机会和同学朋友再聚一聚，有点遗憾
- 长沙真的冷，是冷得脸痛耳朵痛的那种冷，是吹一下冷风要我命的那种冷
- 毕业快2年，一位舍友马上要结婚了，还有一位也开始被家里安排相亲了，时间真的很快...
- 家里的 老 Giant 山地车好久没保养了，好像快不行了，打算去入门公里车了
- 家里原先的办公桌太短了，放不下多个外接屏；简单地设计了一张办公桌，去买了4块木板和一些直角固定支架后手工拼了一张办公桌，钉钉子和拧螺丝真的搞到手痛，感觉我可以去做木匠了doge
![WoodTable](/static/images/WoodTable.jpg)



## 学习

- 继续学习 [Redis 源码剖析与实战](https://time.geekbang.org/column/intro/430)，当时花了99，现在只要59了，好亏啊，怎么也要多学点才能回本






